<!DOCTYPE html>
<html>
<head>
    <title>System Reports</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
    body { background: #fff8e1; }
    .card { border: none; background: #fff3cd; }
    h2, h4 { color: #e67e22; }
    .btn-orange { background-color: #e67e22; color: white; border: none; }
    .btn-orange:hover { background-color: #ca6f1e; }

    /* Custom table styling */
    table { background: #fff3cd; }
    thead { background: #e67e22; color: white; }
    tbody tr:nth-child(even) { background: #fdebd0; }
    tbody tr:nth-child(odd) { background: #fff8e1; }
    td, th { border-color: #f0b27a !important; }
</style>

</head>
<body>
      <!-- Header -->
  <nav class="navbar navbar-expand-lg sticky-top" style="background-color: #0d47a1;">
    <div class="container-fluid">
      <a class="navbar-brand fw-bold text-white" href="/">E-Government Portal</a>
      <div class="d-flex align-items-center">
        <a href="/" class="nav-link text-white me-3">Home</a>
        <a href="/help" class="nav-link text-white me-3">Help</a>
        <form action="/logout" method="POST" class="d-inline">
          <button type="submit" class="btn btn-light btn-sm">Logout</button>
        </form>
      </div>
    </div>
  </nav>
  
<div class="container mt-5">

    <!-- Summary Section -->
    <div class="card shadow-lg p-4 mb-4">
        <h2 class="text-center">Summary Reports</h2>
        <table class="table table-bordered mt-3">
            <thead class="table-dark">
                <tr>
                    <th>Report Type</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Total Users</td><td><%= summary.total_users %></td></tr>
                <tr><td>Total Departments</td><td><%= summary.total_departments %></td></tr>
                <tr><td>Total Services</td><td><%= summary.total_services %></td></tr>
                <tr><td>Total Requests</td><td><%= summary.total_requests %></td></tr>
                <tr><td>Approved Requests</td><td><%= summary.approved_requests %></td></tr>
                <tr><td>Rejected Requests</td><td><%= summary.rejected_requests %></td></tr>
                <tr><td>Pending Payment</td><td><%= summary.awaiting_payment %></td></tr>
                <tr><td>Total Payments</td><td><%= summary.total_payments %></td></tr>
            </tbody>
        </table>
    </div>

    <!-- Detailed Activity Log -->
    <div class="card shadow-lg p-4">
        <h4 class="text-center">Detailed Activity Log</h4>
        <table class="table table-hover mt-3">
            <thead class="table-dark">
                <tr>
                    <th>User</th>
                    <th>Service</th>
                    <th>Department</th>
                    <th>Status</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                <% if (details.length > 0) { %>
                    <% details.forEach(row => { %>
                        <tr>
                            <td><%= row.user_name %></td>
                            <td><%= row.service_name %></td>
                            <td><%= row.department_name %></td>
                            <td><%= row.status %></td>
                            <td><%= new Date(row.created_at).toLocaleString() %></td>
                        </tr>
                    <% }) %>
                <% } else { %>
                    <tr><td colspan="5" class="text-center">No activity found</td></tr>
                <% } %>
            </tbody>
        </table>
    </div>

    <div class="text-center mt-3">
        <a href="/admin_dashboard" class="btn btn-dark">Back</a>
    </div>

</div>
</body>
</html>
